# MVP Trade Triggers
# These scripted triggers provide essential checks for trade functionality
# Basic version focused on Silk Road trade and minimal economy
# Checks if a county is on the Silk Road
is_on_silk_road_trigger = {
	# County can be directly on the route or close enough to benefit
	OR = {
		# Direct Silk Road county (has the flag)
		has_county_flag = on_silk_road
		# County is within trading distance of a Silk Road node
		any_neighboring_county = {
			has_county_flag = on_silk_road
		}
		# County has a silk road trade node
		any_trade_node = {
			OR = {
				# Exact node matching
				node_id = xian_node
				node_id = dunhuang_node
				node_id = kashgar_node
				node_id = samarkand_node
				node_id = bukhara_node
				node_id = merv_node
				node_id = nishapur_node
				node_id = rayy_node
				node_id = baghdad_node
				node_id = mosul_node
				node_id = aleppo_node
				node_id = antioch_node
				node_id = constantinople_node
			}
		}
	}
}

# Checks if a county produces a specific trade good
has_trade_good_trigger = {
	# $TRADE_GOOD$ = ID of the trade good to check for
	# If a specific trade good is provided, check for that
	OR = {
		# County has the specific trade good flag
		has_county_flag = produces_$TRADE_GOOD$
		# County terrain matches production requirements
		AND = {
			# The check works with a scope to the county
			$TRADE_GOOD$ = {
				# Check if county terrain matches any of the production terrain types
				any_in_list = {
					variable = production_terrain
					this = {
						root = {
							terrain = $VALUE$
						}
					}
				}
			}
		}
		# County has a building that produces this good
		has_building = $TRADE_GOOD$_production
	}
}

# Checks if a county has a specific level of trade prosperity
has_trade_prosperity_trigger = {
	# $LEVEL$ = Optional prosperity level to check for (low, medium, high)
	# If no level is specified, checks for any prosperity
	OR = {
		# Check for any prosperity if no level specified
		AND = {
			NOT = {
				is_variable_set = $LEVEL$
			}
			OR = {
				has_modifier = low_trade_prosperity
				has_modifier = medium_trade_prosperity
				has_modifier = high_trade_prosperity
			}
		}
		# Check for low prosperity
		AND = {
			$LEVEL$ = low
			has_modifier = low_trade_prosperity
		}
		# Check for medium prosperity
		AND = {
			$LEVEL$ = medium
			has_modifier = medium_trade_prosperity
		}
		# Check for high prosperity
		AND = {
			$LEVEL$ = high
			has_modifier = high_trade_prosperity
		}
	}
}
